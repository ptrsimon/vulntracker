#!/usr/bin/python3
#
# Vulnerability.py - describe a single CVE
#

from AffectedVersion import AffectedVersion

class Vulnerability:
    def __init__(self, cveid, cpe, severity, description, human_name):
        self.cveid = cveid
        self.cpe = cpe
        self.severity = severity
        self.description = description
        self.affected_versions = []
        self.human_name = human_name

    def __str__(self):
        printstr = self.cveid + "," + self.cpe + "," + self.severity + ","

        for i in self.affected_versions:
            printstr += str(i) + " "

        return printstr

    def ParseAffectedVersions(self, cpe_match_array):
        for i in cpe_match_array:
            version = AffectedVersion()
            if "versionStartExcluding" in i:
                version.start_version = i["versionStartExcluding"]
                version.start_version_excluding = True
            elif "versionStartIncluding" in i:
                version.start_version = i["versionStartIncluding"]
                version.start_version_excluding = False
            if "versionEndExcluding" in i:
                version.end_version = i["versionEndExcluding"]
                version.end_version_excluding = True
            elif "versionEndIncluding" in i:
                version.end_version = i["versionEndIncluding"]
                version.end_version_excluding = False

            if version.start_version != 0 or version.end_version != 0:
                self.affected_versions.append(version)
